#!/usr/bin/env bash



echo "Error!"
exit 125

BUILD_DIR=$1
CACHE_DIR=$2


printenv

for file in "$ENV_DIR"/*
do
  [[ -f "$file" ]] || continue
  var="${file##*/}"
  if
    printf -v "$var" "$(<"$file")" 2>/dev/null
  then
    export "$var"
  else
    echo "Invalid filename: $file"
  fi
done

cd $BUILD_DIR
/app/.heroku/python/bin/python heroku_buildpack.py

mkdir -p $CACHE_DIR/.heroku/data
cp $BUILD_DIR/data/processed_data.pkl "$CACHE_DIR/.heroku/data/processed_data.pkl"